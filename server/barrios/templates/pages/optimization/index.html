{% extends 'dashboard_layout.html' %}

{% block title %}Optimization{% endblock %}

{% block main %}
<section id="main-content" hx-disinherit="*">
  <div class="section-header flex-h flex-between">
  <h1>Optimization</h1>
  <form 
    class="flex-h flex-end gap-2"
    method="POST"
    action="analyze/"
    hx-post="analyze/"
    hx-target="#analysis-section"
    hx-trigger="input, load once"
    hx-swap="outerHTML"
    >
    {% csrf_token %}
    {{ form }}
  </form>
  </div>
  <div id="analysis-section" class="flex-v gap-2">
    {% for mission in missions %}
      <article class="flex-v gap-05 surface">
        <div class="article-header">
          <h3 class="txt-large">{{mission.event_type}}: {{mission.event_date}}</h3>
          <h4>{{mission.vehicle_name}}</h4>
        </div>
        <table>
          <thead>
            <tr style="display: grid; grid-template-columns: 1fr 6fr;"><th>Consumable</th><th>Amount</th></tr>
          </thead>
          <tbody>
          {% for consumable in mission.payload %}
            <tr style="display: grid; grid-template-columns: 1fr 6fr;"><th>{{consumable.name}}</th> <td>{{consumable.amount}}</td><tr>
          {% endfor %}
          </tbody>
        </table>
      </article>
    {% endfor %}
  </div>
</section>

{% endblock %}
